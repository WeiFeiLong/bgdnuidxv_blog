{% load i18n %}
{% load comments %}
{% load static %}


<form method="POST" action="{% comment_form_target %}">
    {% csrf_token %}
    <fieldset>
        <input type="hidden" name="next" value="{% url 'comments-xtd-sent' %}"/>

        <div class="alert alert-danger" data-comment-element="errors" hidden>
        </div>

        {% for field in form %}
        {% if field.is_hidden %}<div>{{ field }}</div>{% endif %}
        {% endfor %}



        <div style="display:none">{{ form.honeypot }}</div>

        <div class="row form-group {% if 'comment' in form.errors %}has-danger{% endif %}">

            <div class="offset-md-1 col-md-12">
                {{ form.comment }}   <!-- 评论内容  -->
            </div>

        </div>


        <table class="table table-hover">
            <thead>
            <tr>
                {% if not request.user.is_authenticated or not request.user.get_full_name %}
                <th  style="text-align: center">昵称</th>
                {% endif %}
                {% if not request.user.is_authenticated or not request.user.email %}
                <th  style="text-align: center">邮箱</th>
                {% endif %}
                {% if not request.user.is_authenticated or not request.user.url %}
                <th  style="text-align: center">网址</th>
                {% endif %}
            </tr>
            </thead>

            <tbody>
            <tr>
                {% if not request.user.is_authenticated or not request.user.get_full_name %}
                <td>{{ form.name }}</td>     <!-- 评论名字  -->
                {% endif %}
                {% if not request.user.is_authenticated or not request.user.email %}
                <td>{{ form.email }}</td>    <!-- 评论邮箱  -->    <!--与是否登陆无关 -->
                {% endif %}
                {% if not request.user.is_authenticated or not request.user.url %}
                <td>{{ form.url }}</td>      <!-- 评论内网址  -->
                {% endif %}
            </tr>
            </tbody>
        </table>

        <div class="row form-group">
            <div class="offset-md-3 col-md-7">
                <div class="custom-control custom-checkbox">
                    {{ form.followup }}
                    <label for="id_followup{% if cid %}_{{ cid }}{% endif %}" class="custom-control-label">&nbsp;{{ form.followup.label }}</label>
                </div>
            </div>
        </div>
    </fieldset>

    <div class="row form-group">
        <div class="offset-md-3 col-md-7">
            <input type="submit" name="post" value="发送" class="btn btn-primary" />
            <input type="button" name="preview" value="预览" class="btn btn-secondary" onclick="myPreview()" />
        </div>
    </div>



    <script>
        $(".django-ckeditor-widget").removeAttr('style');
    </script>
    <script>
        function myPreview(){
            alert("遇到bug 调试中...");
        }
    </script>
    <script>
        // 设置其checked属性,使复选框默认选中[https://developer.mozilla.org/zh-CN/docs/Web/API/Document/querySelector]
        document.querySelector("div.custom-control.custom-checkbox input[name='followup']").checked = true;
    </script>

</form>
